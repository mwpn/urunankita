<main role="main" class="main-content">
  <div class="container-fluid">
    <div class="row justify-content-center">
      <div class="col-12">
        <!-- Page Header -->
        <div class="row align-items-center mb-2">
          <div class="col">
            <h2 class="h5 page-title">Daftar Rekening</h2>
          </div>
          <div class="col-auto">
            <button type="button" class="btn btn-sm btn-primary" data-toggle="modal" data-target="#modalTambahRekening">
              <span class="fe fe-plus fe-12 mr-1"></span>Tambah Rekening
            </button>
          </div>
        </div>

        <!-- Statistik -->
        <div class="row mb-4">
          <div class="col-md-3 mb-3">
            <div class="card shadow">
              <div class="card-body">
                <small class="text-muted d-block mb-1">Total Rekening</small>
                <h3 class="mb-0">8</h3>
                <small class="text-success"><span class="fe fe-arrow-up fe-12"></span> 7 aktif</small>
              </div>
            </div>
          </div>
          <div class="col-md-3 mb-3">
            <div class="card shadow">
              <div class="card-body">
                <small class="text-muted d-block mb-1">Rekening Aktif</small>
                <h3 class="mb-0 text-success">7</h3>
                <small class="text-muted">87.5%</small>
              </div>
            </div>
          </div>
          <div class="col-md-3 mb-3">
            <div class="card shadow">
              <div class="card-body">
                <small class="text-muted d-block mb-1">Rekening Utama</small>
                <h3 class="mb-0">1</h3>
                <small class="text-info">Untuk donasi platform</small>
              </div>
            </div>
          </div>
          <div class="col-md-3 mb-3">
            <div class="card shadow">
              <div class="card-body">
                <small class="text-muted d-block mb-1">Rekening Terverifikasi</small>
                <h3 class="mb-0 text-success">6</h3>
                <small class="text-muted">75%</small>
              </div>
            </div>
          </div>
        </div>

        <!-- Daftar Rekening -->
        <div class="row mb-4">
          <div class="col-md-12">
            <div class="card shadow">
              <div class="card-header">
                <strong class="card-title">Daftar Rekening</strong>
              </div>
              <div class="card-body">
                <div class="table-responsive">
                  <table class="table datatables table-hover" id="dataTable-rekening">
                    <thead>
                      <tr>
                        <th></th>
                        <th>Bank</th>
                        <th>Nomor Rekening</th>
                        <th>Nama Pemilik</th>
                        <th>Tipe</th>
                        <th>Status</th>
                        <th>Verifikasi</th>
                        <th>Action</th>
                      </tr>
                    </thead>
                    <tbody>
                      <tr>
                        <td>
                          <div class="custom-control custom-checkbox">
                            <input type="checkbox" class="custom-control-input">
                            <label class="custom-control-label"></label>
                          </div>
                        </td>
                        <td>
                          <div class="d-flex align-items-center">
                            <div class="mr-3">
                              <span class="fe fe-credit-card fe-24 text-primary"></span>
                            </div>
                            <div>
                              <strong>BCA</strong>
                              <small class="d-block text-muted">Bank Central Asia</small>
                            </div>
                          </div>
                        </td>
                        <td>
                          <strong>1234567890</strong>
                        </td>
                        <td>
                          <strong>PT UrunanKita Platform</strong>
                        </td>
                        <td>
                          <span class="badge badge-primary">Rekening Utama</span>
                        </td>
                        <td>
                          <span class="badge badge-success">Aktif</span>
                        </td>
                        <td>
                          <span class="badge badge-success">Terverifikasi</span>
                        </td>
                        <td>
                          <button class="btn btn-sm dropdown-toggle more-horizontal" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                            <span class="text-muted sr-only">Action</span>
                          </button>
                          <div class="dropdown-menu dropdown-menu-right">
                            <a class="dropdown-item" href="#" data-toggle="modal" data-target="#modalEditRekening"><i class="fe fe-edit fe-12 mr-2"></i>Edit</a>
                            <a class="dropdown-item" href="#"><i class="fe fe-x-circle fe-12 mr-2"></i>Nonaktifkan</a>
                            <div class="dropdown-divider"></div>
                            <a class="dropdown-item text-danger" href="#"><i class="fe fe-trash-2 fe-12 mr-2"></i>Hapus</a>
                          </div>
                        </td>
                      </tr>
                      <tr>
                        <td>
                          <div class="custom-control custom-checkbox">
                            <input type="checkbox" class="custom-control-input">
                            <label class="custom-control-label"></label>
                          </div>
                        </td>
                        <td>
                          <div class="d-flex align-items-center">
                            <div class="mr-3">
                              <span class="fe fe-credit-card fe-24 text-success"></span>
                            </div>
                            <div>
                              <strong>Mandiri</strong>
                              <small class="d-block text-muted">Bank Mandiri</small>
                            </div>
                          </div>
                        </td>
                        <td>
                          <strong>9876543210</strong>
                        </td>
                        <td>
                          <strong>PT UrunanKita Platform</strong>
                        </td>
                        <td>
                          <span class="badge badge-secondary">Rekening Alternatif</span>
                        </td>
                        <td>
                          <span class="badge badge-success">Aktif</span>
                        </td>
                        <td>
                          <span class="badge badge-success">Terverifikasi</span>
                        </td>
                        <td>
                          <button class="btn btn-sm dropdown-toggle more-horizontal" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                            <span class="text-muted sr-only">Action</span>
                          </button>
                          <div class="dropdown-menu dropdown-menu-right">
                            <a class="dropdown-item" href="#" data-toggle="modal" data-target="#modalEditRekening"><i class="fe fe-edit fe-12 mr-2"></i>Edit</a>
                            <a class="dropdown-item" href="#"><i class="fe fe-check-circle fe-12 mr-2"></i>Set sebagai Utama</a>
                            <a class="dropdown-item" href="#"><i class="fe fe-x-circle fe-12 mr-2"></i>Nonaktifkan</a>
                            <div class="dropdown-divider"></div>
                            <a class="dropdown-item text-danger" href="#"><i class="fe fe-trash-2 fe-12 mr-2"></i>Hapus</a>
                          </div>
                        </td>
                      </tr>
                      <tr>
                        <td>
                          <div class="custom-control custom-checkbox">
                            <input type="checkbox" class="custom-control-input">
                            <label class="custom-control-label"></label>
                          </div>
                        </td>
                        <td>
                          <div class="d-flex align-items-center">
                            <div class="mr-3">
                              <span class="fe fe-credit-card fe-24 text-info"></span>
                            </div>
                            <div>
                              <strong>BNI</strong>
                              <small class="d-block text-muted">Bank Negara Indonesia</small>
                            </div>
                          </div>
                        </td>
                        <td>
                          <strong>5555555555</strong>
                        </td>
                        <td>
                          <strong>PT UrunanKita Platform</strong>
                        </td>
                        <td>
                          <span class="badge badge-secondary">Rekening Alternatif</span>
                        </td>
                        <td>
                          <span class="badge badge-success">Aktif</span>
                        </td>
                        <td>
                          <span class="badge badge-warning">Pending</span>
                        </td>
                        <td>
                          <button class="btn btn-sm dropdown-toggle more-horizontal" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                            <span class="text-muted sr-only">Action</span>
                          </button>
                          <div class="dropdown-menu dropdown-menu-right">
                            <a class="dropdown-item" href="#" data-toggle="modal" data-target="#modalEditRekening"><i class="fe fe-edit fe-12 mr-2"></i>Edit</a>
                            <a class="dropdown-item" href="#"><i class="fe fe-check fe-12 mr-2"></i>Verifikasi</a>
                            <a class="dropdown-item" href="#"><i class="fe fe-x-circle fe-12 mr-2"></i>Nonaktifkan</a>
                            <div class="dropdown-divider"></div>
                            <a class="dropdown-item text-danger" href="#"><i class="fe fe-trash-2 fe-12 mr-2"></i>Hapus</a>
                          </div>
                        </td>
                      </tr>
                      <tr>
                        <td>
                          <div class="custom-control custom-checkbox">
                            <input type="checkbox" class="custom-control-input">
                            <label class="custom-control-label"></label>
                          </div>
                        </td>
                        <td>
                          <div class="d-flex align-items-center">
                            <div class="mr-3">
                              <span class="fe fe-credit-card fe-24 text-warning"></span>
                            </div>
                            <div>
                              <strong>BRI</strong>
                              <small class="d-block text-muted">Bank Rakyat Indonesia</small>
                            </div>
                          </div>
                        </td>
                        <td>
                          <strong>1111111111</strong>
                        </td>
                        <td>
                          <strong>Yayasan Peduli</strong>
                        </td>
                        <td>
                          <span class="badge badge-info">Rekening Penggalang</span>
                        </td>
                        <td>
                          <span class="badge badge-success">Aktif</span>
                        </td>
                        <td>
                          <span class="badge badge-success">Terverifikasi</span>
                        </td>
                        <td>
                          <button class="btn btn-sm dropdown-toggle more-horizontal" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                            <span class="text-muted sr-only">Action</span>
                          </button>
                          <div class="dropdown-menu dropdown-menu-right">
                            <a class="dropdown-item" href="#" data-toggle="modal" data-target="#modalEditRekening"><i class="fe fe-edit fe-12 mr-2"></i>Edit</a>
                            <a class="dropdown-item" href="#"><i class="fe fe-x-circle fe-12 mr-2"></i>Nonaktifkan</a>
                            <div class="dropdown-divider"></div>
                            <a class="dropdown-item text-danger" href="#"><i class="fe fe-trash-2 fe-12 mr-2"></i>Hapus</a>
                          </div>
                        </td>
                      </tr>
                    </tbody>
                  </table>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div> <!-- .col-12 -->
    </div> <!-- .row -->
  </div> <!-- .container-fluid -->
</main>

<!-- Modal Tambah Rekening -->
<div class="modal fade" id="modalTambahRekening" tabindex="-1" role="dialog">
  <div class="modal-dialog modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Tambah Rekening Baru</h5>
        <button type="button" class="close" data-dismiss="modal">
          <span>&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <form id="formTambahRekening" class="needs-validation" novalidate>
          <div class="form-group">
            <label>Bank <span class="text-danger">*</span></label>
            <select class="form-control" required>
              <option value="">Pilih Bank</option>
              <option value="bca">BCA - Bank Central Asia</option>
              <option value="mandiri">Mandiri - Bank Mandiri</option>
              <option value="bni">BNI - Bank Negara Indonesia</option>
              <option value="bri">BRI - Bank Rakyat Indonesia</option>
              <option value="cimb">CIMB Niaga</option>
              <option value="danamon">Danamon</option>
              <option value="permata">Permata Bank</option>
              <option value="ocbc">OCBC NISP</option>
              <option value="maybank">Maybank</option>
              <option value="lainnya">Lainnya</option>
            </select>
            <div class="invalid-feedback">Pilih bank</div>
          </div>
          <div class="form-group">
            <label>Nomor Rekening <span class="text-danger">*</span></label>
            <input type="text" class="form-control" placeholder="1234567890" required pattern="[0-9]+">
            <div class="invalid-feedback">Nomor rekening wajib diisi (angka saja)</div>
          </div>
          <div class="form-group">
            <label>Nama Pemilik Rekening <span class="text-danger">*</span></label>
            <input type="text" class="form-control" placeholder="Nama sesuai buku tabungan" required>
            <div class="invalid-feedback">Nama pemilik rekening wajib diisi</div>
            <small class="form-text text-muted">Nama harus sesuai dengan yang tertera di buku tabungan</small>
          </div>
          <div class="form-group">
            <label>Tipe Rekening <span class="text-danger">*</span></label>
            <select class="form-control" required>
              <option value="">Pilih Tipe</option>
              <option value="utama">Rekening Utama (Platform)</option>
              <option value="alternatif">Rekening Alternatif</option>
              <option value="penggalang">Rekening Penggalang</option>
            </select>
            <div class="invalid-feedback">Pilih tipe rekening</div>
          </div>
          <div class="form-group">
            <label>Status</label>
            <select class="form-control">
              <option value="aktif" selected>Aktif</option>
              <option value="nonaktif">Nonaktif</option>
            </select>
          </div>
          <div class="form-group">
            <label>Upload Bukti Rekening (Opsional)</label>
            <div class="dropzone bg-light rounded-lg" id="dropzone-rekening">
              <div class="dz-message needsclick">
                <div class="circle circle-lg bg-primary">
                  <i class="fe fe-upload fe-24 text-white"></i>
                </div>
                <h5 class="text-muted mt-4">Drop file di sini atau klik untuk upload</h5>
                <span class="text-muted">Max: 5MB, Format: JPG/PNG/PDF (Foto buku tabungan atau screenshot rekening)</span>
              </div>
            </div>
            <small class="form-text text-muted">Upload foto buku tabungan atau screenshot untuk verifikasi</small>
          </div>
          <div class="form-group">
            <div class="custom-control custom-checkbox">
              <input type="checkbox" class="custom-control-input" id="verifikasiOtomatisRekening">
              <label class="custom-control-label" for="verifikasiOtomatisRekening">
                Verifikasi otomatis (skip proses verifikasi manual)
              </label>
            </div>
          </div>
        </form>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-dismiss="modal">Batal</button>
        <button type="button" class="btn btn-primary" onclick="simpanRekening()">Simpan Rekening</button>
      </div>
    </div>
  </div>
</div>

<!-- Modal Edit Rekening -->
<div class="modal fade" id="modalEditRekening" tabindex="-1" role="dialog">
  <div class="modal-dialog modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Edit Rekening</h5>
        <button type="button" class="close" data-dismiss="modal">
          <span>&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <form id="formEditRekening">
          <div class="form-group">
            <label>Bank <span class="text-danger">*</span></label>
            <select class="form-control" required>
              <option value="bca" selected>BCA - Bank Central Asia</option>
              <option value="mandiri">Mandiri - Bank Mandiri</option>
              <option value="bni">BNI - Bank Negara Indonesia</option>
              <option value="bri">BRI - Bank Rakyat Indonesia</option>
              <option value="cimb">CIMB Niaga</option>
              <option value="danamon">Danamon</option>
              <option value="permata">Permata Bank</option>
              <option value="ocbc">OCBC NISP</option>
              <option value="maybank">Maybank</option>
              <option value="lainnya">Lainnya</option>
            </select>
          </div>
          <div class="form-group">
            <label>Nomor Rekening <span class="text-danger">*</span></label>
            <input type="text" class="form-control" value="1234567890" required pattern="[0-9]+">
          </div>
          <div class="form-group">
            <label>Nama Pemilik Rekening <span class="text-danger">*</span></label>
            <input type="text" class="form-control" value="PT UrunanKita Platform" required>
          </div>
          <div class="form-group">
            <label>Tipe Rekening <span class="text-danger">*</span></label>
            <select class="form-control" required>
              <option value="utama" selected>Rekening Utama (Platform)</option>
              <option value="alternatif">Rekening Alternatif</option>
              <option value="penggalang">Rekening Penggalang</option>
            </select>
          </div>
          <div class="form-group">
            <label>Status</label>
            <select class="form-control">
              <option value="aktif" selected>Aktif</option>
              <option value="nonaktif">Nonaktif</option>
            </select>
          </div>
          <div class="form-group">
            <label>Status Verifikasi</label>
            <select class="form-control">
              <option value="terverifikasi" selected>Terverifikasi</option>
              <option value="pending">Pending</option>
              <option value="ditolak">Ditolak</option>
            </select>
          </div>
        </form>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-dismiss="modal">Batal</button>
        <button type="button" class="btn btn-primary">Update Rekening</button>
      </div>
    </div>
  </div>
</div>

<script>
  // Initialize DataTable
  (function() {
    function initDataTable() {
      if (typeof $.fn.DataTable !== 'undefined' && $('#dataTable-rekening').length) {
        $('#dataTable-rekening').DataTable({
          autoWidth: true,
          "lengthMenu": [
            [10, 25, 50, -1],
            [10, 25, 50, "All"]
          ],
          "order": [[0, "asc"]],
          "language": {
            "search": "Cari:",
            "lengthMenu": "Tampilkan _MENU_ data per halaman",
            "info": "Menampilkan _START_ sampai _END_ dari _TOTAL_ data",
            "infoEmpty": "Menampilkan 0 sampai 0 dari 0 data",
            "infoFiltered": "(difilter dari _MAX_ total data)",
            "paginate": {
              "first": "Pertama",
              "last": "Terakhir",
              "next": "Selanjutnya",
              "previous": "Sebelumnya"
            }
          },
          "columnDefs": [
            {
              "targets": [0], // Checkbox column
              "orderable": false
            },
            {
              "targets": [7], // Action column
              "orderable": false
            }
          ]
        });
        console.log('DataTable rekening initialized');
      } else {
        console.warn('DataTable library not loaded or table not found');
        setTimeout(initDataTable, 500);
      }
    }

    if (document.readyState === 'loading') {
      document.addEventListener('DOMContentLoaded', function() {
        setTimeout(initDataTable, 300);
      });
    } else {
      setTimeout(initDataTable, 300);
    }
  })();

  // Simpan Rekening
  function simpanRekening() {
    var form = document.getElementById('formTambahRekening');
    if (form.checkValidity()) {
      // TODO: Implement save logic
      alert('Rekening berhasil ditambahkan! (Simulasi)');
      $('#modalTambahRekening').modal('hide');
      form.reset();
      form.classList.remove('was-validated');
    } else {
      form.classList.add('was-validated');
    }
  }

  // Make functions global
  window.simpanRekening = simpanRekening;
</script>

