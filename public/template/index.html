<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="">
    <meta name="author" content="">
    <link rel="icon" href="favicon.ico">
    <title>Dashboard - Urunankita</title>
    <!-- Simple bar CSS -->
    <link rel="stylesheet" href="css/simplebar.css">
    <!-- Fonts CSS -->
    <link href="https://fonts.googleapis.com/css2?family=Overpass:ital,wght@0,100;0,200;0,300;0,400;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,600;1,700;1,800;1,900&display=swap" rel="stylesheet">
    <!-- Icons CSS -->
    <link rel="stylesheet" href="css/feather.css">
    <link rel="stylesheet" href="css/select2.css">
    <link rel="stylesheet" href="css/dropzone.css">
    <link rel="stylesheet" href="css/uppy.min.css">
    <link rel="stylesheet" href="css/jquery.steps.css">
    <link rel="stylesheet" href="css/jquery.timepicker.css">
    <link rel="stylesheet" href="css/quill.snow.css">
    <!-- Date Range Picker CSS -->
    <link rel="stylesheet" href="css/daterangepicker.css">
    <!-- App CSS -->
    <link rel="stylesheet" href="css/app-light.css" id="lightTheme">
    <link rel="stylesheet" href="css/app-dark.css" id="darkTheme" disabled>
    <!-- Custom CSS -->
    <link rel="stylesheet" href="css/custom.css">
  </head>
  <body class="vertical  light  ">
    <div class="wrapper">
      <!-- Header/Navbar -->
      <div id="header-placeholder"></div>
      
      <!-- Sidebar -->
      <div id="sidebar-placeholder"></div>
      
      <!-- Main Content -->
      <div id="main-content-placeholder"></div>
    </div> <!-- .wrapper -->
    
    <!-- Scripts -->
    <div id="scripts-placeholder"></div>
    
    <!-- Load includes using JavaScript -->
    <script>
      // Load header
      fetch('includes/header.html')
        .then(response => response.text())
        .then(data => {
          document.getElementById('header-placeholder').innerHTML = data;
        })
        .catch(error => console.error('Error loading header:', error));
      
      // Load sidebar
      fetch('includes/sidebar.html')
        .then(response => response.text())
        .then(data => {
          document.getElementById('sidebar-placeholder').innerHTML = data;
          // Load sidebar role filter setelah sidebar di-load
          const scriptRole = document.createElement('script');
          scriptRole.src = 'js/sidebar-role.js';
          scriptRole.onload = function() {
            // Load sidebar navigation handler
            const scriptNav = document.createElement('script');
            scriptNav.src = 'js/sidebar-navigation.js';
            scriptNav.onload = function() {
              // Load content loader
              const scriptLoad = document.createElement('script');
              scriptLoad.src = 'js/load-content.js';
              scriptLoad.onload = function() {
                // Initialize sidebar navigation
                if (window.initSidebarNavigation) {
                  setTimeout(function() {
                    window.initSidebarNavigation();
                  }, 100);
                }
              };
              document.body.appendChild(scriptLoad);
            };
            document.body.appendChild(scriptNav);
          };
          document.body.appendChild(scriptRole);
        })
        .catch(error => console.error('Error loading sidebar:', error));
      
      // Load main content (dashboard as default)
      fetch('includes/dashboard-content.html')
        .then(response => response.text())
        .then(data => {
          document.getElementById('main-content-placeholder').innerHTML = data;
        })
        .catch(error => console.error('Error loading main content:', error));
      
      // Load scripts
      fetch('includes/scripts.html')
        .then(response => response.text())
        .then(data => {
          const placeholder = document.getElementById('scripts-placeholder');
          placeholder.innerHTML = data;
          // Re-evaluate scripts after loading
          const scripts = placeholder.querySelectorAll('script');
          scripts.forEach(oldScript => {
            const newScript = document.createElement('script');
            if (oldScript.src) {
              newScript.src = oldScript.src;
            } else {
              newScript.textContent = oldScript.textContent;
            }
            document.body.appendChild(newScript);
            oldScript.remove();
          });
          
          // Initialize chart after scripts loaded
          setTimeout(function() {
            if (typeof ApexCharts !== 'undefined') {
              var options = {
                series: [{
                  name: 'Donasi',
                  data: [45000000, 52000000, 48000000, 61000000, 55000000, 67000000, 63000000]
                }],
                chart: {
                  type: 'area',
                  height: 300,
                  toolbar: {
                    show: false
                  }
                },
                dataLabels: {
                  enabled: false
                },
                stroke: {
                  curve: 'smooth'
                },
                xaxis: {
                  categories: ['Sen', 'Sel', 'Rab', 'Kam', 'Jum', 'Sab', 'Min']
                },
                tooltip: {
                  y: {
                    formatter: function (val) {
                      return "Rp " + val.toLocaleString('id-ID');
                    }
                  }
                }
              };
              var chart = new ApexCharts(document.querySelector("#donasiChart"), options);
              chart.render();
            }
          }, 500);
        })
        .catch(error => console.error('Error loading scripts:', error));
      
      // Initialize date range picker
      setTimeout(function() {
        if (typeof jQuery !== 'undefined' && jQuery.fn.daterangepicker) {
          jQuery('#reportrange').daterangepicker({
            opens: 'left',
            locale: {
              format: 'DD/MM/YYYY'
            }
          }, function(start, end, label) {
            console.log("Date range selected");
          });
        }
      }, 1000);
    </script>
  </body>
</html>
